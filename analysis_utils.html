<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Predictive Analysis" href="analysis_pred_utils.html" /><link rel="prev" title="Simulation Utilities" href="sim_utils.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Analysis Utilities - GridCellsCond</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">GridCellsCond</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">GridCellsCond</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulations.html">Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="param.html">Parameters</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="utility_functions.html">Utility Functions</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Utility Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sim_utils.html">Simulation Utilities</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Analysis Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis_pred_utils.html">Predictive Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="conn_utils.html">Connectivity Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="instr_utils.html">Instrumentation Utilities</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/analysis_utils.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-analysis_utils">
<span id="analysis-utilities"></span><h1>Analysis Utilities<a class="headerlink" href="#module-analysis_utils" title="Link to this heading">¶</a></h1>
<p>Analysis functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.bin_spike_ms">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">bin_spike_ms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spks_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_dur</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#analysis_utils.bin_spike_ms" title="Link to this definition">¶</a></dt>
<dd><p>Bin spike times into a binary matrix with millisecond resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>sim_dur</strong> (<em>float or int</em>) – Duration of the simulation in milliseconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A binary matrix of shape (number of cells, sim_dur)
where each row corresponds to a cell and each column corresponds to
a millisecond. A value of 1 indicates a spike at that millisecond,
and 0 indicates no spike.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.build_and_return_matrix">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">build_and_return_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specs_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#analysis_utils.build_and_return_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Builds and returns an connectivity matrix for a given simulation ID.</p>
<p>Used to analyze the connectivity of a simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_id</strong> (<em>str</em>) – The ID of the simulation to load parameters for.</p></li>
<li><p><strong>specs_file</strong> (<em>str</em>) – The path to a specifications file (not implemented).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The adjacency matrix generated for the given simulation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.calc_fft">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">calc_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5e-05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.calc_fft" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the Fast Fourier Transform for a given signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – The signal to calculate the FFT for.</p></li>
<li><p><strong>T</strong> (<em>float, optional</em>) – The time step of the signal. Default is 0.000025s default dt for neuron.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>f (np.ndarray): The frequency array.</p></li>
<li><p>y (np.ndarray): The FFT of the signal.</p></li>
<li><p>power (np.ndarray): The power spectrum of the signal.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.calc_firing_rates">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">calc_firing_rates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spk_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_dur</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.calc_firing_rates" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the average firing rates of neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spk_list</strong> (<em>list of lists</em>) – Spike times of each neuron</p></li>
<li><p><strong>sim_dur</strong> (<em>float</em>) – The duration of the simulation in milliseconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The average firing rate of the neurons in Hz.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.calc_grid_field_sizes_time">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">calc_grid_field_sizes_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.calc_grid_field_sizes_time" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the sizes of grid fields along the time axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>avg</strong> (<em>bool, optional</em>) – Whether to return the average field size. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If avg is True, returns the median field size.
Otherwise, returns a list of all field sizes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.calc_grid_scales_time">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">calc_grid_scales_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.calc_grid_scales_time" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the scale of grid fields along the time axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>avg</strong> (<em>bool, optional</em>) – Whether to return the average scale size. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If avg is True, returns the median scale size. Otherwise,
returns a list of all scale sizes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.calc_speed_of_network">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">calc_speed_of_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spks_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.calc_speed_of_network" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the speed of the network.</p>
<p>This function calculates the speed of the network by decoding the position
of the network and calculating the slope of the unwrapped position.
It assumes the input DC to network was constant</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spks_l</strong> (<em>list</em>) – List of spike timings for stellate cells.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the simulation parameters.</p></li>
<li><p><strong>win_size</strong> (<em>int, optional</em>) – Window size for instantaneous rate calculation.
Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The slope representing the speed of the network.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.clean_spikes">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">clean_spikes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.clean_spikes" title="Link to this definition">¶</a></dt>
<dd><p>Cleans spikes from the given spike trains using a threshold-based approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>order</strong> (<em>float, optional</em>) – Factor to determine the strictness of threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of spike trains with cleaned spikes, where each spike train
is represented as a list of spike times.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.decode_pos">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">decode_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.decode_pos" title="Link to this definition">¶</a></dt>
<dd><p>Decode position for neuronal activity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Parameter dictionary of simulation parameters.</p></li>
<li><p><strong>t_start</strong> (<em>int, optional</em>) – Start time for decoding. Default is 0.</p></li>
<li><p><strong>t_end</strong> (<em>int, optional</em>) – End time for decoding. Default is None.</p></li>
<li><p><strong>win_size</strong> (<em>int, optional</em>) – Window size for calculating the instantaneous
rate. Default is 150.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decoded position</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.generate_2d_video">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">generate_2d_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_to_save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.generate_2d_video" title="Link to this definition">¶</a></dt>
<dd><p>Generates a video for the 2D model</p>
<p>Video is saved as data/{sim_id}/{sim_id}_{sheet_to_save}.mp4</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_id</strong> (<em>str</em>) – The simulation ID to load spikes and parameters.</p></li>
<li><p><strong>sheet_to_save</strong> (<em>int, optional</em>) – The sheet index to save (1-4). Defaults to 0.
Index 4 is the interneuron sheet.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>generate_2d_video(“BaseModel2D”, sheet_to_save=2)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.grid_field_sizes_neurons">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">grid_field_sizes_neurons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size_t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.grid_field_sizes_neurons" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the grid field sizes along the neuron axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spks</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>sim_dur</strong> (<em>float</em>) – Duration of the simulation in milliseconds.</p></li>
<li><p><strong>avg</strong> (<em>bool, optional</em>) – If True, return the average grid field size.
If False, return all grid field sizes. Defaults to True.</p></li>
<li><p><strong>win_size_t</strong> (<em>int, optional</em>) – Time window size in milliseconds for analysis.
Defaults to 1000.</p></li>
<li><p><strong>win_size_n</strong> (<em>int, optional</em>) – Number of windows for analysis. Defaults to 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average grid field size if avg is True, otherwise a list
of all grid field sizes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.grid_props_2D">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">grid_props_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inst_rates_reshaped</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.grid_props_2D" title="Link to this definition">¶</a></dt>
<dd><p>Calculate 2D grid properties.</p>
<p>Calculate the grid score, grid scale, and grid size from the 2D autocorrelation of firing rate map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inst_rates_reshaped</strong> (<em>numpy.ndarray</em>) – 3D array of reshaped instantaneous
rates (cellxcellxtime).</p></li>
<li><p><strong>t</strong> (<em>int</em>) – Time index to use for the calculation. Default is -1000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">auto_corr</span></code> (numpy.ndarray): Normalized 2D autocorrelation matrix.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_score</span></code> (float): Grid score calculated from the autocorrelation matrix.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_scale</span></code> (float): Median distance of the closest objects from the center.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_size</span></code> (float): Median size of the grid cells.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.grid_scale_neurons">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">grid_scale_neurons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.grid_scale_neurons" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the grid scale along the neuron axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for stellate neurons.</p></li>
<li><p><strong>sim_dur</strong> (<em>int</em>) – Duration of the simulation in milliseconds.</p></li>
<li><p><strong>win_size</strong> (<em>int, optional</em>) – Size of the window for periodic activity
calculation in milliseconds. Defaults to 1000.</p></li>
<li><p><strong>stdev</strong> (<em>int, optional</em>) – Standard deviation for smoothing the periodic
activity. Defaults to 3.</p></li>
<li><p><strong>avg</strong> (<em>bool, optional</em>) – If True, returns the average difference between peaks.
If False, returns all differences. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If <cite>avg</cite> is True, returns the average difference between peaks as a float.
If <cite>avg</cite> is False, returns a list of differences between peaks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.instant_rate">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">instant_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spike_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.instant_rate" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the instantaneous firing rate from a spike train using Gaussian convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_train</strong> (<em>list or array-like</em>) – A list or array of spike times.</p></li>
<li><p><strong>sim_dur</strong> (<em>float</em>) – The duration of the simulation in milliseconds.</p></li>
<li><p><strong>stdev</strong> (<em>float</em>) – The standard deviation of the Gaussian window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The instantaneous firing rate as a numpy array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.instant_rate_all">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">instant_rate_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_dur</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#analysis_utils.instant_rate_all" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the instantaneous firing rate for all cells using Gaussian kernel convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>sim_dur</strong> (<em>float</em>) – The duration of the simulation in milliseconds.</p></li>
<li><p><strong>stdev</strong> (<em>float</em>) – The standard deviation of the Gaussian kernel used for convolution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array (cell X t_ms) where each
row corresponds to the instantaneous firing rate of a cell.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.integrate_array">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">integrate_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.integrate_array" title="Link to this definition">¶</a></dt>
<dd><p>Integrate an array using Simpson’s rule.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.periodic_activity_all">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">periodic_activity_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_dur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.periodic_activity_all" title="Link to this definition">¶</a></dt>
<dd><p>Instantaneous firing rate for all cells using Gaussian kernel convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for stellate cells.</p></li>
<li><p><strong>sim_dur</strong> (<em>int</em>) – Total duration of the simulation in milliseconds.</p></li>
<li><p><strong>window_t</strong> (<em>int</em>) – Time window for binning spikes in milliseconds.</p></li>
<li><p><strong>stdev</strong> (<em>float</em>) – Standard deviation for the Gaussian kernel used in convolution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered spike activity array with periodic activity highlighted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.separate_fields">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">separate_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.separate_fields" title="Link to this definition">¶</a></dt>
<dd><p>Separates spike trains into grid fields based on a threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stell_spikes_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with keys as cell indices and values as
lists of lists of separated grid fields,</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.shift_fields_to_center">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">shift_fields_to_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stell_spikes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#analysis_utils.shift_fields_to_center" title="Link to this definition">¶</a></dt>
<dd><p>Shift the separated grid fields of spike trains to center them around zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stell_spikes</strong> (<em>list of lists</em>) – Spike times for each neuron.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary with keys as cell indices and values as lists of
shifted grid fields.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="analysis_utils.spks_to_rate_reshaped">
<span class="sig-prename descclassname"><span class="pre">analysis_utils.</span></span><span class="sig-name descname"><span class="pre">spks_to_rate_reshaped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spks_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#analysis_utils.spks_to_rate_reshaped" title="Link to this definition">¶</a></dt>
<dd><p>Convert spike times to firing rates and reshape based on cell position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spks_l</strong> (<em>list of lists</em>) – Spike times for each neuron.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Parameter dictionary containing simulation parameters.</p></li>
<li><p><strong>win_size</strong> (<em>float, optional</em>) – Window size for calculating the
instantaneous rate. Default is 200.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reshaped matrix of instantaneous firing rates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="analysis_pred_utils.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Predictive Analysis</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="sim_utils.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Simulation Utilities</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Inayath Shaikh
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Analysis Utilities</a><ul>
<li><a class="reference internal" href="#analysis_utils.bin_spike_ms"><code class="docutils literal notranslate"><span class="pre">bin_spike_ms()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.build_and_return_matrix"><code class="docutils literal notranslate"><span class="pre">build_and_return_matrix()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.calc_fft"><code class="docutils literal notranslate"><span class="pre">calc_fft()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.calc_firing_rates"><code class="docutils literal notranslate"><span class="pre">calc_firing_rates()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.calc_grid_field_sizes_time"><code class="docutils literal notranslate"><span class="pre">calc_grid_field_sizes_time()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.calc_grid_scales_time"><code class="docutils literal notranslate"><span class="pre">calc_grid_scales_time()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.calc_speed_of_network"><code class="docutils literal notranslate"><span class="pre">calc_speed_of_network()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.clean_spikes"><code class="docutils literal notranslate"><span class="pre">clean_spikes()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.decode_pos"><code class="docutils literal notranslate"><span class="pre">decode_pos()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.generate_2d_video"><code class="docutils literal notranslate"><span class="pre">generate_2d_video()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.grid_field_sizes_neurons"><code class="docutils literal notranslate"><span class="pre">grid_field_sizes_neurons()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.grid_props_2D"><code class="docutils literal notranslate"><span class="pre">grid_props_2D()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.grid_scale_neurons"><code class="docutils literal notranslate"><span class="pre">grid_scale_neurons()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.instant_rate"><code class="docutils literal notranslate"><span class="pre">instant_rate()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.instant_rate_all"><code class="docutils literal notranslate"><span class="pre">instant_rate_all()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.integrate_array"><code class="docutils literal notranslate"><span class="pre">integrate_array()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.periodic_activity_all"><code class="docutils literal notranslate"><span class="pre">periodic_activity_all()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.separate_fields"><code class="docutils literal notranslate"><span class="pre">separate_fields()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.shift_fields_to_center"><code class="docutils literal notranslate"><span class="pre">shift_fields_to_center()</span></code></a></li>
<li><a class="reference internal" href="#analysis_utils.spks_to_rate_reshaped"><code class="docutils literal notranslate"><span class="pre">spks_to_rate_reshaped()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=01f34227"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    </body>
</html>